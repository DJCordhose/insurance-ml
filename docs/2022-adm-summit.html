<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10.0, user-scalable=yes">

	<title>AMD Summit 2022: ML</title>

	<link rel="stylesheet" href="revealjs/reveal.js/dist/reset.css" />
    <link rel="stylesheet" href="revealjs/reveal.js/dist/reveal.css" />
    <link rel="stylesheet" href="revealjs/reveal.js/dist/theme/white.css" />

    <!-- Theme used for syntax highlighted code -->
	<!-- <link rel="stylesheet" href="revealjs/reveal.js/plugin/highlight/monokai.css"> -->
	<link rel="stylesheet" href="revealjs/reveal.js/plugin/highlight/zenburn.css">
    <link rel="stylesheet" href="revealjs/highlight-js-github-theme.css" />
    <link rel="stylesheet" href="revealjs/styles.css" />

</head>

<body style="background-color: whitesmoke;">
	<div class="reveal">
		<div class="slides">

<section data-markdown class="local preparation hide">
</section>


<!-- 
Künstliche Intelligenz als Disziplin der Software Entwicklung

Klassische Business Logik eignet sich oft dafür, durch einen datengetriebenen Ansatz oder andere Techniken aus dem
Bereich der KI ersetzt zu werden. Man erhofft sich dadurch eine bessere Wartbarkeit, Robustheit und letztlich auch eine
bessere Genauigkeit.

In diesem Workshop werden wir ein Stück klassischen Code durch ein Maschine Learning Modell ersetzen. Dabei betrachten
wir die Frage, wo die Grenze eines solchen Modells sind, wie man es in eine ja meistens gegebene klassische Umgebung
einbindet und wie man entscheidet, ob ein großes Modell besser geeignet ist als mehrere kleine. Hier kommt die Frage
Monolith vs kleinere Services also von neuem wieder auf.

Technisch werden in einem Java Umfeld arbeiten und daher ist es vorteilhaft, eine Java Entwicklungsumgebung auf einem
Laptop mitzubringen. Letztlich ist aber jeder willkommen, da es eher um Prinzipien als Details im Code gehen wird.
 -->

 <section data-markdown class="todo">
### aktuell

1. Musterlösung erzeugen
  1. Übungen durchgehen


Nice to have
1. Modell nach TF.js wandeln
1. wie kriegt man fertiges Tf Modell auf Aws geservt? Also nicht erst über Sagemaker Notebooks
1. Link auf Prod in Android: http://newsletter.victordibia.com/issues/running-machine-learning-models-on-android-devices-issue-9-1199608
  </section>
			<section data-markdown>
				<textarea data-template>
## Künstliche Intelligenz als Disziplin der Software Entwicklung
                
API, Microservices und DDD Summit 2022, https://api-summit.de/cloudnative-devops/kuenstliche-intelligenz-als-disziplin-der-software-entwicklung/

Oliver Zeigermann
oliver.zeigermann@openknowledge.de

Folien: https://bit.ly/amd-summit-2022-ml

    </textarea>
			</section>

			
<section data-markdown>
  <textarea data-template>
### Wer ist Olli

<div style="display: flex;">
<div style="flex: 50%;">
  <a href='https://oreilly.de/produkt/machine-learning-kurz-gut-2/'>
  <img src='img/ml-buch-v2.jpg' height="400">
  </a>
</div>
<div style="flex: 50%; font-size: x-large;">
  <img src='img/olli-opa.jpeg'>
</div>
</div>
<p>
<a target="_blank" href="mailto:oliver.zeigermann@openknowledge.de">Oliver Zeigermann</a>:
Head of AI@OpenKnowledge
</p>    
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
### Wer seid ihr?

* Was macht ihr?
* Was wisst ihr schon?
* Warum seid ihr hier?
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
# Agenda

1. Unsere Beispielanwendung
1. Klassische Regeln
1. Lösung mit Machine Learning (ML)
1. Ein ML Modell in Java integrieren
1. ML als Monolith?
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
# Agenda

1. _Unsere Beispielanwendung_
1. Klassische Regeln
1. Lösung mit Machine Learning (ML)
1. Ein ML Modell in Java integrieren
1. ML als Monolith?
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
## Unser Beispiel: Vorhersage von Risiken

* Wir sind CTO einer hochinnovativen Kfz-Versicherungsgesellschaft
* Anders als andere Versicherungsgesellschaften bestimmen wir den Tarif anhand der geschätzen Anzahl von Unfällen pro Kunde
* Zielsetzung: Wie viele Unfälle werden die potenziellen Kunden haben?

<img src='img/pixabay/accident-151668_1280.png' style="height: 230px">
</textarea>
</section>

<section>
	<h3>Klassifizierung basierend auf bekannten Daten</h3>
	<img src="img/insurance-new/train-data.png" height="500px" class="fragment">
</section>


<section data-markdown>
	<textarea data-template>
### Vorhersage von Risiken für potenzielle Kunden

<a href='html/calculator.html'>
<img src='img/calculator.png' height="400">
</a>
<p><small>
<a href='html/calculator.html' target="_blank">
https://djcordhose.github.io/ml-resources/html/calculator.html</a></small>
</small></p>
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
# Agenda

1. Unsere Beispielanwendung
1. _Klassische Regeln_
1. Lösung mit Machine Learning (ML)
1. Ein ML Modell in Java integrieren
1. ML als Monolith?
</textarea>
</section>

<section data-markdown class="hands-on">
	<textarea data-template>
### Hands-On I		

Gemeinsame Vorbereitung
1. Im Verzeichnis `workspace-java` ist ein Java-Projekt vorbereitet
1. In `workspace-java/app/src/main/java/eu/zeigermann/ml/App.java` gibt es ein Code-Gerüst für diesen Workshop
1. `./gradlew run` bzw. `gradle.bat run` starten das Projekt

Durchführung im Team
1. Tut euch in Teams von mindestens 2 Personen zusammen
1. Mindestens eine Person sollte Java-Code auf dem eigenen Rechner ausführen können
1. Diskutiert wie ihr die Aufgabe mit klassischen Regeln lösen könnt
1. Implementiert die Regeln und bestimmt wie gut diese das Problem lösen
1. Wie weit könnt ihr den Score von 33% nach oben bringen?
	</textarea>
</section>

<section data-markdown class="hands-on">
	<textarea data-template>
### Hands-On Ib

1. Ändert die einzulesende Datei auf `insurance-customers-risk-1500-test.csv`
1. Wie verändert sich der Score?
1. Was könnte sich hier verändert haben?
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
# Agenda

1. Unsere Beispielanwendung
1. Klassische Regeln
1. _Lösung mit Machine Learning (ML)_
1. Ein ML Modell in Java integrieren
1. ML als Monolith?
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
<img src='img/classic-development.jpg' style="height: 600px;">
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
<img src='img/supervised-ml.jpg' style="height: 600px;">
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
### Man muss sein Problem so formulieren, dass es für ML greifbar wird

<img src='img/software-complexity.png'>

<small>
Andrej Karpathy - TRAIN AI 2018 - Building the Software 2.0 Stack

https://vimeo.com/272696002

</small>
	</textarea>
</section>


<section data-markdown>
    <textarea data-template>
### Machine Learning können in Phasen strukturiert werden

<img src='img/sketch/phases-ml.png'>

</textarea>
</section>

	<section data-markdown class="fragments">
### Phase 1: Exploration

* in der ersten Phase eines Machine Learning Projekts wird die Anwendungsidee validiert und ein
funktionsfähiges Modell entwickelt.
* dabei ist ein schnelles iterieren und ausprobieren von Ideen zentral
* das Ziel ist *nicht* ein sinnvolles Stück Software
* Scripting passt hier besser als Programmieren als Ausdruck für die Tätigkeit
* das Ziel ist eine schnelle Entwicklung
* Phase 1 endet entweder mit
  * einem funktionsfähigen Modell mit dem man in Phase II übergeht oder
  * dem Verwerfen des Ansatzes

	</section>

<section data-markdown>
### Neuronale Netzwerke sind ein mächtiges Mittel für ML	
## TensorFlow is defacto Standard

_TensorFlow is an end-to-end open source platform for machine learning. It has a comprehensive, flexible ecosystem of
tools, libraries and community resources that lets researchers push the state-of-the-art in ML and developers easily
build and deploy ML powered applications._

https://www.tensorflow.org/
</section>

<section data-markdown>
    <textarea data-template>
## Deployment ist ein Schwerpunkt

<img src='img/tf-deploy.png'>

<small>

* https://www.tensorflow.org/tfx/guide/serving
* https://www.tensorflow.org/lite/api_docs
* https://www.tensorflow.org/js

</small>

</textarea>
</section>

<section data-markdown>
## Aber mit welcher Programmiersprache?

### Und wieso ist das eigentlich Python? (Spoiler)
</section>

<section data-markdown>
	<textarea data-template>
### Unterschiedliche Projekte für TensorFlow mit Java

1. https://github.com/tensorflow/tensorflow/blob/master/tensorflow/java/README.md
   * Alte Version auf Basis von JNI, nur Core für die Ausführung von Modellen
   * https://www.tensorflow.org/api_docs/java/org/tensorflow/package-summary
   * Stabil, aber veraltet
1. https://www.tensorflow.org/jvm
  * Das aktuelle Projekt
  * Unterstützt nicht nur Deployment, sondern die volle API inkl. Training
  * Hat strategische Bedeutung, ist aber noch nicht stabil
  * Unterprojekt: https://github.com/tensorflow/java-ndarray

</textarea>
</section>

<section data-markdown>
	<textarea data-template>
### TensorFlow Java hat seine eigene Version

Stabilitätsgarantien gelten nicht für Java

<img src="img/tf-java-versions.png">

https://github.com/tensorflow/java/#tensorflow-version-support
</textarea>
</section>

<section data-markdown class="fragments">
	<textarea data-template>
### Aber: Wieso eigentlich Neuronale Netzwerke in Java?        

* Training von Neuronalen Netzen ist eher Scripting
* Sprachmittel von Java sind nach wie vor umständlich für Scripting
* Aber: vielleicht reicht eine einfache Integration eines ML-Modells in Java mit Standard-Schnittstellen?
  * GRPC, REST, MQTT, etc.  

    </textarea>
</section>

	<section data-markdown>
		<textarea data-template>
### Analogie: Build-Tool und ML-Training

* Ein Build-Script macht aus Java-Quellen ein ausführbares Programm
* Ein Trainings-Script macht aus einer ML-Architektur und Daten ein ausführbares TensorFlow Modell
* Ein Build-Script schreiben wir auch in Java nicht in Java selbst
* Entweder nutzen wir eine Script-Sprache (Groovy oder Kotlin)
* Oder eine noch weiter standadisierte, deklarative Beschreibung (XML)
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
### Python für ML

* Python ist perfekt für Scripting
* Hat die größte Community in dem Bereich
* Python hat die besten Bibliotheken und Werkzeuge
</textarea>
</section>


	<section data-markdown>
<textarea data-template>
## ML Training als (Build) Script	
### Literate Statistical Programming

1. Intent
1. Code
1. Data
1. Results
1. (Interpretation)

_Die Idee wird in sogenannten "notebooks" implementiert_

<small>https://en.wikipedia.org/wiki/Literate_programming</small>
<br>
<small>https://education.arcus.chop.edu/literate-statistical-programming/</small>

</textarea>
</section>

<section data-markdown style="font-size: x-large;">
	<textarea data-template>
## Live Coding - Notebooks, interaktive Skripte

### Wie fühlt sich Arbeit in Notebooks an?

https://colab.research.google.com/github/DJCordhose/insurance-ml/blob/main/workspace-java/insurance_ml.ipynb

</textarea>
</section>

<section data-markdown class="hands-on">
	<textarea data-template>
### Hands-On II		

1. Bringe das Notebook auf Colab zum laufen
1. Trainiere ein eigenes Modell und lade es auf deinen Rechner herunter
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
# Agenda

1. Unsere Beispielanwendung
1. Klassische Regeln
1. Lösung mit Machine Learning (ML)
1. _Ein ML Modell in Java integrieren_
1. ML als Monolith?
</textarea>
</section>


<section data-markdown>
	<textarea data-template>
### TensorFlow Modelle können als Graph abgespeichert werden

<img src="https://raw.githubusercontent.com/tensorflow/docs/master/site/en/guide/images/intro_to_graphs/two-layer-network.png">

* https://www.tensorflow.org/guide/intro_to_graphs
* https://www.tensorflow.org/api_docs/python/tf/Graph#as_graph_def 
</textarea>
</section>

<section data-markdown class="fragments">
	<textarea data-template>
### Warum interessiert uns das?

* Graphen enthalten alles was man zur Ausführung eines Neuronalen Netzes braucht
* Damit kann man die Python-Welt verlassen
* Man braucht lediglich eine Umgebung, die die Operationen in dem Graphen ausführen kann
* So eine Umgebung ist bereits in TensorFlow mit C++ implementiert und auch die Python-Version beruht darauf  
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
### Serving

* Erlauben direkt Ausführung eines Graphen im Server-Betrieb
* Modell-Server kann lokal unter Linux installiert werden
* Oder man kann so ein Modell direkt bei GCP deployen
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
### Serving

```
saved_model_cli show --dir insurance-classifier --all
```

```
export TF_CPP_VMODULE=http_server=1

nohup tensorflow_model_server --port=8500 --rest_api_port=8501 \
  --model_name=insurance --model_base_path=/home/olli/insurance-model  >server.log 2>&1
```

https://www.tensorflow.org/tfx/guide/serving
https://www.tensorflow.org/tfx/serving/setup
</textarea>
</section>

<section>
<h3>TensorFlow Modelle können auch direkt aus Java aufgerufen</h3>

<pre>
    <code data-trim><script type="text/template">
try (var savedModelBundle = SavedModelBundle.load("insurance-ml/app/classifier", "serve")) {

    var input_matrix = NdArrays.ofFloats(Shape.of(1, 2));
    input_matrix.set(NdArrays.vectorOf(48.0f, 100.0f), 0);
    Tensor input_tensor = TFloat32.tensorOf(input_matrix);
    Map<String, Tensor> inputTensorMap = new HashMap<>();
    inputTensorMap.put("input", input_tensor);

    var myFunction = savedModelBundle.function("serving_default");
    Map<String, Tensor> outputTensorMap = myFunction.call(inputTensorMap);
    var prediction = outputTensorMap.get("output");

    // overly complicated way to get the prediction, but so far found no better way
    var probas = prediction.asRawTensor().data().asFloats();
    float redProba = probas.getFloat(0);
    float yellowProba = probas.getFloat(1);
    float greenProba = probas.getFloat(2);
}
        
</script></code>
</pre>
</section>

<section data-markdown>
	<textarea data-template>
### Lokale Vorhersage

```
gcloud ai-platform local predict --model-dir /home/olli/insurance-model/1 \
  --json-instances  sample_insurance.json \
  --framework tensorflow
```

https://cloud.google.com/ai-platform/prediction/docs/deploying-models#test_your_model_with_local_predictions
</textarea>
</section>


<!-- 

ACHTUNG: DAS HIER IST AKTUELLER ALS DIE NÄCHSTEN BEIDEN FOLIEN

gcloud auth login
gcloud config set project ml-project-213311

// https://cloud.google.com/storage/docs/naming-buckets?_ga=2.159882297.-561421399.1653816440
gsutil mb gs://eu_zeigermann_ml_insurance_1
gsutil cp -R /home/olli/insurance-model/1 gs://eu_zeigermann_ml_insurance_1


gcloud ai-platform models create "ml_insurance" --region=europe-west1 --enable-logging
gcloud ai-platform versions create "v1" --model "ml_insurance" --region=europe-west1 --framework tensorflow  --runtime-version=2.8 --origin "gs://eu_zeigermann_ml_insurance_1/1"
gcloud ai-platform versions describe "v1" --region=europe-west1 --model "ml_insurance"

gcloud ai-platform predict --region=europe-west1 --model "ml_insurance" --version "v1" --json-instances sample_insurance.json

Aufruf aus Java: https://cloud.google.com/ai-platform/prediction/docs/online-predict#java
Dependencies: https://github.com/GoogleCloudPlatform/java-docs-samples/blob/ab20245137332ff8ba6285f9a66f3f8bb1558b52/mlengine/online-prediction/pom.xml
 -->
        <section>
<h3>Modell auf Google Clound ML deployen</h3>

<div class="fragment">
    <p>Modell in einen Cloud Bucket kopieren</p>
<pre><code contenteditable data-trim class="python">
gsutil mb gs://eu_zeigermann_ml_insurance_1
gsutil cp -R /home/olli/insurance-model/1 gs://eu_zeigermann_ml_insurance_1
</code></pre>
<p><small>
Erfordert Google Cloud SDK:         
    <a href='https://cloud.google.com/sdk/install'>https://cloud.google.com/sdk/install</a></small></p>
</div>
<div class="fragment">
    <p>Deployment aus diesem Bucket</p>
<pre><code contenteditable data-trim class="python">
gcloud ai-platform models create "ml_insurance" --region=europe-west1 --enable-logging
gcloud ai-platform versions create "v1" --model "ml_insurance" --region=europe-west1 --framework tensorflow \
 --runtime-version=2.8 --origin "gs://eu_zeigermann_ml_insurance_1/1"
gcloud ai-platform versions describe "v1" --region=europe-west1 --model "ml_insurance"
</code></pre>
<p><small>
<a href='https://cloud.google.com/ml-engine/docs/tensorflow/deploying-models'>
    https://cloud.google.com/ml-engine/docs/tensorflow/deploying-models</a>
<br>
<a href='https://cloud.google.com/ml-engine/docs/tensorflow/prediction-overview#prediction_logging'>
    https://cloud.google.com/ml-engine/docs/tensorflow/prediction-overview#prediction_logging</a></small></p>
</div>

    </section>

<section>
<h3>Anfragen</h3>

<div class="fragment">
    <p>Das Input-format ist ein bisschen sonderbar</p>
<pre><code contenteditable data-trim class="python">
# sample_insurance.json    
{"input": [ 18, 160 ]}
{"input": [ 51, 100]}
{"input": [ 20, 90]}    
</code></pre>
</div>
<div class="fragment">
    <p>Aufruf</p>
<pre><code contenteditable data-trim class="python fragment">
gcloud ai-platform predict --region=europe-west1 --model "ml_insurance" --version "v1" \
 --json-instances ./sample_insurance.json

</code></pre>
<pre><code contenteditable data-trim class="python fragment">
Wahrscheinlichkeiten pro Klasse
[[0.982429862, 0.0175378807, 3.22602682e-05], 
[0.012407572, 0.333301514, 0.654291], 
[0.00413073646, 0.985944033, 0.00992520899]]
</code></pre>
</div>

<p><small>
<a href='https://cloud.google.com/ml-engine/docs/tensorflow/online-predict'>https://cloud.google.com/ml-engine/docs/tensorflow/online-predict</a>
</small></p>

</section>

        <!-- <section class="todo">
<h3>Making Predictions from Python</h3>

<div class="fragment">
    <p>First we need a few more libraries</p>
<pre><code contenteditable data-trim class="python">
pip install google-api-python-client
pip install tensorflow-serving-api
</code></pre>
</div>
<div class="fragment">
    <p>Input needs to conform to JSON now</p>
<pre><code contenteditable data-trim class="python">
instances = [{"inputs": [100,  47,  10]}]
predict_json("ml_project", "ml_insurance", instances=instances)
</code></pre>
<pre><code contenteditable data-trim class="python fragment">
[{'scores': 
  [0.002760800765827298, 0.8720880746841431, 0.12515118718147278]}]
</code></pre>
</div>

<p><small>
<a href='https://cloud.google.com/ml-engine/docs/tensorflow/online-predict'>https://cloud.google.com/ml-engine/docs/tensorflow/online-predict</a>
</small></p>

    </section>

            <section class="todo">
<h3>Python API</h3>

<div class="fragment">
<pre><code contenteditable data-trim class="python">
import googleapiclient.discovery

def predict_json(project, model, instances):
    service = googleapiclient.discovery.build('ml', 'v1')
</code></pre>
<pre><code contenteditable class="python fragment">    name = 'projects/{}/models/{}'.format(project, model)

    response = service.projects().predict(
        name=name,
        body={'instances': instances}
    ).execute()

    return response['predictions']</code></pre>
</div>

<p><small>
<a href='https://cloud.google.com/ml-engine/docs/tensorflow/online-predict'>https://cloud.google.com/ml-engine/docs/tensorflow/online-predict</a>
<br>
<a href='https://github.com/GoogleCloudPlatform/python-docs-samples/blob/master/ml_engine/online_prediction/predict.py'>
    https://github.com/GoogleCloudPlatform/python-docs-samples/blob/master/ml_engine/online_prediction/predict.py
</a>

</small></p>

    </section>

        <section class="todo">
<h3>TensorFlow Serving REST API</h3>

<div class="fragment">
<p>Starting the Model Server in Rest Mode (needs Linux)</p>

<pre><code contenteditable data-trim>
tensorflow_model_server --rest_api_port=8501 \
--model_name=manning_insurance_1 \
--model_base_path=$(pwd)/tf
</code></pre>
<p><small><a href='https://www.tensorflow.org/serving/api_rest'>https://www.tensorflow.org/serving/api_rest</a></small></p>
</div>

<div class="fragment">
<p>Curling to it</p>

<pre><code contenteditable data-trim class="python">
curl -X POST \
http://localhost:8501/v1/models/manning_insurance_1:predict  \
-d '{ "instances": [{"inputs": [ 100.0,  47.0,  10.0]}]}' 
# {
#     "predictions": [[0.0027608, 0.872088, 0.125151]]
# }</code></pre>
</div>

<p class="fragment"><small>
    <em>Note</em>: To make this work from a browser you need a server in between, because 
    <a href='https://enable-cors.org/'>CORS</a> makes an 
    <a href='js/serving-sandbox.html'>
        OPTION request</a>
     that is not implemented by model server</small></p>

    </section>
 -->

        <section>
<h3>Alternative: Im Browser deployen</h3>

<div class="fragment">
<p>Keras Model nach TensorFlow.js konvertieren</p>

<pre><code contenteditable data-trim class="python">
tensorflowjs_converter --input_format keras \
./model/insurance.hdf5 \
./tfjs    
</code></pre>
<p><small><a href='https://js.tensorflow.org/tutorials/import-keras.html'>
    https://js.tensorflow.org/tutorials/import-keras.html</a></small></p>

</div>

<div class="fragment">
<p>Nutzung im Browser</p>

            <pre><code contenteditable data-trim class="fragment line-numbers javascript">
const model = await tf.loadModel('tfjs/model.json');
            </code></pre>
            <pre><code contenteditable data-trim class="fragment line-numbers javascript">
// age, max speed
const example = tf.tensor([[47, 100]]);
const prediction = model.predict(example);
console.log(await prediction.data());
//[0.00334801129065454, 0.8710343241691589, 0.12561771273612976]
    </code></pre>

    </div>   
    </section>

<section data-markdown class="hands-on">
	<textarea data-template>
### Hands-On III		

1. Binde das Modell in deinen Java-Code ein
1. Entweder als direkten Aufruf
1. Oder wandle das Modell in JS, um es direkt im Browser zu nutzen
   * https://www.tensorflow.org/js/tutorials/conversion/import_saved_model 
1. Oder rufe einen Server auf
   1. starte einen TensorFlow Server (geht nur unter Linux)
      * https://www.tensorflow.org/tfx/serving/setup
   1. oder bringe da Modell in der Cloud zum laufen
      * https://cloud.google.com/ai-platform/prediction/docs/deploying-models
1. Wie ist der Score des Modells mit den beiden Datensätzen? 

_Wähle den direkten Aufruf, es sei denn du hast bereits Erfahrung in den anderen Varianten der Produktion_
</textarea>
</section>


<section data-markdown>
	<textarea data-template>

<!-- <img src='img/6monts-later.jpg' height="600px"> -->
<img src='img/2year-later.jpg' height="600px">

</textarea>
</section>


<section data-markdown data-transition="none">
	<textarea data-template>
## Ergebnis des Modells nach zwei Jahren

<img src='img/insurance-new/insurance-after-shift.png' class="fragment">

</textarea>
</section>


<section data-markdown data-transition="none">
	<textarea data-template>
## Ursprüngliche Daten zum direkten Vergleich

<img src='img/insurance-new/insurance-pred.png'>

</textarea>
</section>

<section data-markdown class="fragments">
	<textarea data-template>
### Was ist hier passiert? 

*Die Welt steht nicht still - Model und Welt laufen auseinander, aus 70%  Genauigkeit werden 65%*

* Elektroautos finden weitere Verbreitung
* potente Elektroautos haben allgemein deutlich geringere Höchstgeschwindigkeit 
* aber super Beschleunigung
* Gute Beschleunigung ist viel eher Ursache für rasante Fahrweise, Unfallwahrscheinlichkeit ist hoch
* Wir haben aber nur Höchstgeschwindigkeit als Daten (seht im Fahrzeugschein), Korrelation war angenommen
* Der Cluster mit jungen, schlechten Fahrern ist nach unten gerutscht
* _Wird nun fälschlich als gut vorhergesagt und werden günstig versichert_
<!-- * Tatsächlich sehen wir aber viele Unfälle -->
<!-- - Faherer vielleicht ein bisschen älter geworden -->
</textarea>
</section>

<!-- <section data-markdown>
	<textarea data-template>
<img src='img/model-eval.png'>

<small>

https://twitter.com/marktenenholtz/status/1528021809697792003</small>
		</textarea>
</section>
	 -->
<section data-markdown class="fragments">
### Grundregel

* Alle haben Probleme in Produktion
* Es gibt kein fehlerfreies System 
  * jedenfalls nicht für lange
* Ziel ist es, Fehler schnell 
  * zu entdecken
  * zu analysieren
  * und entsprechende ihrer Schwere zu adressieren

</section>

	<section data-markdown class="fragments">
		<textarea data-template>
### Woher weiß man, dass man ein neues Modell in Produktion braucht?

1. Mindestens einmal im Jahr, damit man überhaupt noch weiß wie es geht
1. Wenn die Metrik des Modells nachlässt in Produktion
1. Dafür braucht man die Ground Truth der Daten aus Produktion
1. Manchmal bekommt man diese unmittelbar nach der Vorhersage durch die Reaktion eines menschlichen Benutzers
1. Oft aber auch erst nach nennenswerter Verzögerung 
1. Wenn sich die Verteilung der Daten der Anfragen deutlich von denen des Trainings unterscheiden 

</textarea>
	</section>

<section data-markdown class="hands-on">
	<textarea data-template>
### Hands-On IIIb		

1. Der Datensatz `insurance-customers-risk-1500-shift.csv` drückt den beschriebenen Shift aus
1. Bestimme die Performance des Modelle mit diesem Datensatz
1. Wie würdest du mit den unterschiedlichen Ansätzen, auch diesen Datensatz gut abdecken?
1. Wie würde das mit mehr als 2 Dimensionen funktionieren?
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
# Agenda

1. Unsere Beispielanwendung
1. Klassische Regeln
1. Lösung mit Machine Learning (ML)
1. Ein ML Modell in Java integrieren
1. _ML als Monolith?_
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
### Ein großes Modell oder (mehrere) kleinere		
<img src="img/sketch/small-model.jpg">
</textarea>
</section>

<section data-markdown class="todo">
	<textarea data-template>
# Zusammenfassung
</textarea>
</section>



			<section data-markdown>
				<textarea data-template>
# Vielen Dank

Künstliche Intelligenz als Disziplin der Software Entwicklung

API, Microservices und DDD Summit 2022, https://api-summit.de/muenchen/

Bleibt gern im Kontakt

Oliver Zeigermann

https://www.linkedin.com/in/oliver-zeigermann-34989773/

oliver.zeigermann@openknowledge.de

https://twitter.com/DJCordhose

Folien: https://bit.ly/amd-summit-2022-ml

    </textarea>
			</section>


		</div>
	</div>

	<script src="revealjs/reveal.js/dist/reveal.js"></script>
	<script src="revealjs/reveal.js/plugin/notes/notes.js"></script>
	<script src="revealjs/reveal.js/plugin/markdown/markdown.js"></script>
	<script src="revealjs/reveal.js/plugin/highlight/highlight.js"></script>
	<script src="revealjs/config.js"></script>


</body>

</html>